angular.module('vnBrickModule',function () {})
.directive('vnBrick', function(  ) {
    return {
      restrict: 'E',
      controller: function( $scope, $rootScope, $timeout, vnWorkflowFactory ){
      	
      	vnWorkflowFactory.addTaskCardTo( $scope.$index, true );

		$scope.minFieldsSatisfiedHandler = function( isSatisfied ){
			var isLastInChain = $rootScope.taskoutercreators.length - 1 ==  $scope.$index;
			if( isLastInChain ){
				$scope.outeritem.showouterbrick = isSatisfied;
			}
			$scope.outeritem.showinnerbrick = isSatisfied;
			$rootScope.invalidcardopen = !isSatisfied;
		};

		$scope.handleCardClick = function( e ){
			console.log( e );
			if( this.inneritem.minimise == true ){
				//this.inneritem.minimise = false;
			}
			
		};

		$scope.handleInnerAddClick = function( createNew ){
			vnWorkflowFactory.addTaskCardTo( $scope.$index, createNew );
		};
      },
      templateUrl: 'apps/visiontasks/workflow/vnbrick.html'
    };
});