angular.module('vnAppManagementModule', [],function () {})
.factory('vnAppManagementFactory', function( $rootScope, vnActionFactory ){
	var factory = {};
	var registeredApps = {};

	factory.registerApp = function( app ){
		registeredApps[ app.id ] = app;
		if( $rootScope.screens == null ){
			$rootScope.screens = {};
		}
		angular.forEach( app.screens, function( value, index ){
			$rootScope.screens[value] = false;
			var app = value.split( '__' );
			if( app != null ){
				$rootScope.screens[app[0]] = false;
			}
		});

		angular.forEach( app.imableto, function( value, index ){
			vnActionFactory.registerHelper( value.name, value.helperfunction );
		});
		
	};

	factory.deregisterApp = function( app ){
		delete registeredApps[ app.id ];
	};

	factory.getDefaultApp = function(){
		var returnValue;
		angular.forEach( factory.getApps(), function( value, index ){
			if( value.defaultapp ){
				returnValue = value;
			}
		});
		return returnValue;
	};

	factory.getApp = function( id ){
		var returnApp = registeredApps[ id ];
		return returnApp;
	};

	factory.getApps = function(){
		return registeredApps;
	};

	return factory;
});